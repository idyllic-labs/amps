---
name: research-integration
inputs:
  question: text
outputs:
  - report
  - sources
---

# Research: {question}

First, identify 3 key aspects to investigate.

<Structured name="aspects">
  <Field name="items" type="list">
    <Field name="aspect" type="text" />
    <Field name="searchQuery" type="text" />
  </Field>
</Structured>

<Loop name="research" over={aspects.items}>

  ## {item.aspect}

  <WebSearch name="search" query={item.searchQuery} maxResults={3} />

  Synthesize the findings for this aspect.

  <Generation name="synthesis" />

</Loop>

# Final Report

Compile all findings into a comprehensive report.

<Generation name="report" />

<Set name="sources" value={research.flatMap(r => r.search.results.map(s => s.url))} />
